[2025-05-21 18:00:15,189: INFO/MainProcess] beat: Starting...
[2025-05-21 18:04:14,262: INFO/MainProcess] beat: Starting...
[2025-05-21 18:11:31,185: INFO/MainProcess] beat: Starting...
[2025-05-21 18:13:28,994: INFO/MainProcess] beat: Starting...
[2025-05-21 18:30:12,037: INFO/MainProcess] beat: Starting...
[2025-05-21 18:34:04,565: INFO/MainProcess] beat: Starting...
[2025-05-21 18:36:28,077: INFO/MainProcess] beat: Starting...
[2025-05-21 18:47:01,164: INFO/MainProcess] beat: Starting...
[2025-05-21 18:47:23,754: INFO/MainProcess] beat: Starting...
[2025-05-21 18:58:17,748: INFO/MainProcess] beat: Starting...
[2025-05-21 18:59:58,028: INFO/MainProcess] beat: Starting...
[2025-05-21 19:09:18,490: INFO/MainProcess] beat: Starting...
[2025-05-21 19:16:11,862: INFO/MainProcess] beat: Starting...
[2025-05-21 19:22:02,141: INFO/MainProcess] beat: Starting...
[2025-05-21 19:35:34,462: INFO/MainProcess] beat: Starting...
[2025-05-21 19:41:50,514: INFO/MainProcess] beat: Starting...
[2025-05-22 04:00:00,157: INFO/MainProcess] Scheduler: Sending due task celery.backend_cleanup (celery.backend_cleanup)
[2025-05-22 04:00:00,222: ERROR/MainProcess] Message Error: Couldn't apply scheduled task celery.backend_cleanup: You can't write against a read only replica.
['  File "/opt/backoffice-api/venv/bin/celery", line 8, in <module>\n    sys.exit(main())\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/__main__.py", line 15, in main\n    sys.exit(_main())\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/bin/celery.py", line 231, in main\n    return celery(auto_envvar_prefix="CELERY")\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/click/core.py", line 1161, in __call__\n    return self.main(*args, **kwargs)\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/click/core.py", line 1082, in main\n    rv = self.invoke(ctx)\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/click/core.py", line 1697, in invoke\n    return _process_result(sub_ctx.command.invoke(sub_ctx))\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/click/core.py", line 1443, in invoke\n    return ctx.invoke(self.callback, **ctx.params)\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/click/core.py", line 788, in invoke\n    return __callback(*args, **kwargs)\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/click/decorators.py", line 33, in new_func\n    return f(get_current_context(), *args, **kwargs)\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/bin/base.py", line 135, in caller\n    return f(ctx, *args, **kwargs)\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/bin/beat.py", line 70, in beat\n    return beat().run()\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/apps/beat.py", line 84, in run\n    self.start_scheduler()\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/apps/beat.py", line 113, in start_scheduler\n    service.start()\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/beat.py", line 644, in start\n    interval = self.scheduler.tick()\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/beat.py", line 354, in tick\n    self.apply_entry(entry, producer=self.producer)\n', '  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/beat.py", line 284, in apply_entry\n    exc, traceback.format_stack(), exc_info=True)\n']
Traceback (most recent call last):
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/connection.py", line 472, in _reraise_as_library_errors
    yield
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/connection.py", line 556, in _ensured
    return fun(*args, **kwargs)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/common.py", line 155, in _maybe_declare
    entity.declare(channel=channel)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/entity.py", line 617, in declare
    self._create_queue(nowait=nowait, channel=channel)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/entity.py", line 628, in _create_queue
    self.queue_bind(nowait=nowait, channel=channel)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/entity.py", line 672, in queue_bind
    return self.bind_to(self.exchange, self.routing_key,
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/entity.py", line 681, in bind_to
    return (channel or self.channel).queue_bind(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/transport/virtual/base.py", line 577, in queue_bind
    self._queue_bind(exchange, *meta)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/transport/redis.py", line 1045, in _queue_bind
    client.sadd(self.keyprefix_queue % (exchange,),
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/redis/commands/core.py", line 3329, in sadd
    return self.execute_command("SADD", name, *values)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/redis/client.py", line 559, in execute_command
    return self._execute_command(*args, **options)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/redis/client.py", line 567, in _execute_command
    return conn.retry.call_with_retry(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/redis/retry.py", line 62, in call_with_retry
    return do()
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/redis/client.py", line 568, in <lambda>
    lambda: self._send_command_parse_response(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/redis/client.py", line 542, in _send_command_parse_response
    return self.parse_response(conn, command_name, **options)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/redis/client.py", line 584, in parse_response
    response = connection.read_response()
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/redis/connection.py", line 616, in read_response
    raise response
redis.exceptions.ReadOnlyError: You can't write against a read only replica.

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/beat.py", line 403, in apply_async
    return task.apply_async(entry_args, entry_kwargs,
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/app/task.py", line 601, in apply_async
    return app.send_task(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/app/base.py", line 922, in send_task
    amqp.send_task_message(P, name, message, **options)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/app/amqp.py", line 523, in send_task_message
    ret = producer.publish(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/messaging.py", line 190, in publish
    return _publish(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/connection.py", line 556, in _ensured
    return fun(*args, **kwargs)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/messaging.py", line 208, in _publish
    maybe_declare(entity, retry=retry, **retry_policy)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/messaging.py", line 107, in maybe_declare
    return maybe_declare(entity, self.channel, retry, **retry_policy)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/common.py", line 112, in maybe_declare
    return _imaybe_declare(entity, channel, **retry_policy)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/common.py", line 169, in _imaybe_declare
    return entity.channel.connection.client.ensure(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/connection.py", line 594, in _ensured
    errback and errback(exc, 0)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/connection.py", line 476, in _reraise_as_library_errors
    raise ConnectionError(str(exc)) from exc
kombu.exceptions.OperationalError: You can't write against a read only replica.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/beat.py", line 281, in apply_entry
    result = self.apply_async(entry, producer=producer, advance=False)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/beat.py", line 411, in apply_async
    reraise(SchedulingError, SchedulingError(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/exceptions.py", line 109, in reraise
    raise value.with_traceback(tb)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/beat.py", line 403, in apply_async
    return task.apply_async(entry_args, entry_kwargs,
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/app/task.py", line 601, in apply_async
    return app.send_task(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/app/base.py", line 922, in send_task
    amqp.send_task_message(P, name, message, **options)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/celery/app/amqp.py", line 523, in send_task_message
    ret = producer.publish(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/messaging.py", line 190, in publish
    return _publish(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/connection.py", line 556, in _ensured
    return fun(*args, **kwargs)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/messaging.py", line 208, in _publish
    maybe_declare(entity, retry=retry, **retry_policy)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/messaging.py", line 107, in maybe_declare
    return maybe_declare(entity, self.channel, retry, **retry_policy)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/common.py", line 112, in maybe_declare
    return _imaybe_declare(entity, channel, **retry_policy)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/common.py", line 169, in _imaybe_declare
    return entity.channel.connection.client.ensure(
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/connection.py", line 594, in _ensured
    errback and errback(exc, 0)
  File "/usr/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/opt/backoffice-api/venv/lib/python3.8/site-packages/kombu/connection.py", line 476, in _reraise_as_library_errors
    raise ConnectionError(str(exc)) from exc
celery.beat.SchedulingError: Couldn't apply scheduled task celery.backend_cleanup: You can't write against a read only replica.
[2025-05-22 17:17:12,284: INFO/MainProcess] beat: Starting...
[2025-05-22 17:31:33,880: INFO/MainProcess] beat: Starting...
[2025-05-22 18:08:10,950: INFO/MainProcess] beat: Starting...
[2025-05-22 18:12:00,869: INFO/MainProcess] beat: Starting...
[2025-05-22 18:18:47,658: INFO/MainProcess] beat: Starting...
[2025-05-22 18:25:05,836: INFO/MainProcess] beat: Starting...
[2025-05-22 18:27:02,628: INFO/MainProcess] beat: Starting...
[2025-05-22 18:28:42,774: INFO/MainProcess] beat: Starting...
[2025-05-22 18:31:34,264: INFO/MainProcess] beat: Starting...
[2025-05-22 18:34:56,859: INFO/MainProcess] beat: Starting...
[2025-05-22 18:35:19,074: INFO/MainProcess] beat: Starting...
[2025-05-22 19:35:21,886: INFO/MainProcess] beat: Starting...
[2025-05-22 19:37:28,509: INFO/MainProcess] beat: Starting...
[2025-05-22 20:05:55,750: INFO/MainProcess] beat: Starting...
[2025-05-22 20:08:52,622: INFO/MainProcess] beat: Starting...
[2025-05-22 20:13:53,728: INFO/MainProcess] beat: Starting...
[2025-05-22 20:31:00,963: INFO/MainProcess] beat: Starting...
[2025-05-22 20:31:32,225: INFO/MainProcess] beat: Starting...
[2025-05-22 20:53:42,366: INFO/MainProcess] beat: Starting...
[2025-05-22 21:03:33,667: INFO/MainProcess] beat: Starting...
[2025-05-22 21:06:11,222: INFO/MainProcess] beat: Starting...
[2025-05-22 21:07:09,706: INFO/MainProcess] beat: Starting...
[2025-05-22 21:08:50,786: INFO/MainProcess] beat: Starting...
[2025-05-22 21:09:15,167: INFO/MainProcess] beat: Starting...
[2025-05-22 21:09:40,885: INFO/MainProcess] beat: Starting...
[2025-05-22 21:10:48,978: INFO/MainProcess] beat: Starting...
[2025-05-22 21:12:41,034: INFO/MainProcess] beat: Starting...
[2025-05-22 21:15:49,722: INFO/MainProcess] beat: Starting...
[2025-05-22 21:17:28,962: INFO/MainProcess] beat: Starting...
[2025-05-22 22:12:45,760: INFO/MainProcess] beat: Starting...
[2025-05-22 22:15:51,233: INFO/MainProcess] beat: Starting...
[2025-05-22 22:25:40,722: INFO/MainProcess] beat: Starting...
[2025-05-22 22:34:27,127: INFO/MainProcess] beat: Starting...
[2025-05-22 22:36:51,503: INFO/MainProcess] beat: Starting...
[2025-05-23 04:00:00,372: INFO/MainProcess] Scheduler: Sending due task celery.backend_cleanup (celery.backend_cleanup)
[2025-05-23 18:03:04,294: INFO/MainProcess] beat: Starting...
[2025-05-23 18:57:11,635: INFO/MainProcess] beat: Starting...
[2025-05-23 19:28:25,605: INFO/MainProcess] beat: Starting...
[2025-05-23 19:39:43,081: INFO/MainProcess] beat: Starting...
[2025-05-23 20:10:57,351: INFO/MainProcess] beat: Starting...
[2025-05-23 20:25:03,664: INFO/MainProcess] beat: Starting...
